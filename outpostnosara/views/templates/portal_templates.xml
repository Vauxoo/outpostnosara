<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="reservation_form" name="Reservation Form">
       <div class="container">
            <div class="ou ou-reservation" >
                <form action="/shop/address" method="post" autocomplete='off'>
                    <section class="js_reservation">
                        <h4 class="" >Reservation</h4>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label class="col-form-label" for="room_type_id">Room Type</label>
                                <select id="room_type_id" name="room_type_id" class="form-control">
                                    <t t-foreach='room_types' t-as='room_type'>
                                        <t t-set='room_id' t-value='len(room_type.room_ids) == 1 and room_type.room_ids[:1].id or False' />
                                        <option t-att-value="room_type.id" t-att-data-rooms="len(room_type.room_ids)" t-att-data-roomid="room_id" t-esc='room_type.name'/>
                                    </t>
                                </select>
                            </div>
                            <div class="form-group col-md-6">
                                <label class="col-form-label" for="reservation_type_id">Reservation Type</label>
                                <select id="reservation_type_id" name="reservation_type_id" class="form-control">
                                    <option value="">Choose</option>
                                    <t t-foreach='reservation_types' t-as='reservation_type'>
                                        <option t-att-data-code="reservation_type.code" t-att-value="reservation_type.id" t-esc='reservation_type.name'/>
                                    </t>
                                </select>
                            </div>
                        </div>
                    </section>

                    <section class="js_reservation_day d-none">
                        <h4 class="" >Daily</h4>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label class="col-form-label" for="checkin">Checkin</label>
                                <input type="text" name="checkin" class="form-control ou-daterangepicker"/>
                            </div>
                            <div class="form-group col-md-6">
                                <label class="col-form-label" for="checkout">Checkout</label>
                                <input type="text" name="checkout" class="form-control ou-daterangepicker"/>
                            </div>
                            <t t-set="reservation_daily_id" t-value="request.env.ref('outpostnosara.reservation_type_by_day').id"/>
                            <t t-if="reservation_daily_id in podcast_types" t-call="outpostnosara.add_podcast_addon"/>
                        </div>
                        <span>Questions about how to fill this field? <a href="https://youtu.be/VmjNqpTlTyA">Click here</a></span>
                    </section>
                    <section class="js_reservation_hour d-none">
                        <h4 class="" >Hourly</h4>
                        <div class="form-row">
                            <div class="form-group col-12">
                                <label class="col-form-label" for="checkin">Day</label>
                                <input type="text" name="checkin" data-singledatepicker='1' class="form-control ou-daterangepicker single"/>
                            </div>
                            <div class="form-group col-md-6">
                                <label class="col-form-label" for="arrival_hour">Arrival Hour</label>
                                <select id="arrival_hour" name="arrival_hour" class="form-control ou-reset">
                                    <option value="06:00">06:00 A.M</option>
                                    <option value="07:00">07:00 A.M</option>
                                    <option value="08:00">08:00 A.M</option>
                                    <option value="09:00">09:00 A.M</option>
                                    <option value="10:00">10:00 A.M</option>
                                    <option value="11:00">11:00 A.M</option>
                                    <option value="12:00">12:00 P.M</option>
                                    <option value="13:00">01:00 P.M</option>
                                    <option value="14:00">02:00 P.M</option>
                                    <option value="15:00">03:00 P.M</option>
                                    <option value="16:00">04:00 P.M</option>
                                </select>
                            </div>
                            <div class="form-group col-md-6">
                                <label class="col-form-label" for="departure_hour">Departure Hour</label>
                                <select id="departure_hour" name="departure_hour" class="form-control ou-reset">
                                    <option value="08:00">08:00 A.M</option>
                                    <option value="09:00">09:00 A.M</option>
                                    <option value="10:00">10:00 A.M</option>
                                    <option value="11:00">11:00 A.M</option>
                                    <option value="12:00">12:00 A.M</option>
                                    <option value="13:00">01:00 P.M</option>
                                    <option value="14:00">02:00 P.M</option>
                                    <option value="15:00">03:00 P.M</option>
                                    <option value="16:00">04:00 P.M</option>
                                    <option value="17:00">05:00 P.M</option>
                                    <option value="18:00">06:00 P.M</option>
                                </select>
                            </div>
                        </div>
                        <t t-set="reservation_hour_id" t-value="request.env.ref('outpostnosara.reservation_type_by_hour').id"/>
                        <t t-if="reservation_hour_id in podcast_types" t-call="outpostnosara.add_podcast_addon"/>
                    </section>
                    <section class="js_reservation_half d-none">
                        <h4 class="" >1/2 Day</h4>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label class="col-form-label" for="checkin">Day</label>
                                <input type="text" name="checkin" data-singledatepicker='1' class="form-control ou-daterangepicker single"/>
                            </div>
                            <div class="form-group col-md-6">
                                <label class="col-form-label" for="hour">Time</label>
                                <select id="hour" name="hour" class="form-control ou-reset">
                                    <option value="06:00-12:00">Morning (06:00 A.M - 12:00 P.M)</option>
                                    <option value="12:30-18:00">Afternoon (12:30 P.M - 06:00 P.M)</option>
                                </select>
                            </div>
                        </div>
                        <t t-set="reservation_half_id" t-value="request.env.ref('outpostnosara.reservation_type_by_half_day').id"/>
                        <t t-if="reservation_half_id in podcast_types" t-call="outpostnosara.add_podcast_addon"/>
                    </section>
                    <section class="js_reservation_button d-none border-bottom-0">
                        <t t-call='outpostnosara.reservation_validator_button'/>
                    </section>
                    <section class="js_reservation_price d-none text-right border-bottom-0 text-bold">
                        <h5>Reservation Total: $ <span class="oe_currency_value"/></h5>
                    </section>
                </form>

                <section t-if="not user.partner_id.is_harmony" class="js_reservation_payment d-none border-bottom-0">
                    <div id="payment_method" class="" t-if="(acquirers or pms)">
                        <h4 class="">Payment</h4>
                        <t t-call="payment.payment_tokens_list">
                            <t t-set="mode" t-value="'payment'"/>
                            <t t-set="submit_txt">Pay Now</t>
                            <t t-set="icon_right" t-value="1"/>
                            <t t-set="icon_class" t-value="'fa-chevron-right'"/>
                            <t t-set="submit_class" t-value="'btn btn-primary text-uppercase'"/>
                            <t t-set="pms" t-value="pms"/>
                            <t t-set="form_action" t-value="'/outpost/pay/invoice/token'"/>
                            <t t-set="prepare_tx_url" t-value="'/outpost/pay/invoice/form_tx'"/>
                            <t t-set="partner_id" t-value="partner"/>
                            <t t-set="success_url" t-value="'/outpost/reservation/confirmation'"/>
                            <t t-set="error_url" t-value="'/outpost/reservation/confirmation'"/>
                        </t>
                    </div>

                    <div t-if="not acquirers" class="mt-2">
                        <a role="button" class="btn-link" groups="base.group_system" t-attf-href="/web#action=#{payment_action_id}">
                                <i class="fa fa-arrow-right"/> Add payment acquirers
                        </a>
                    </div>
                </section>
                <t t-else="" t-call="outpostnosara.harmony_reservation_form"/>
            </div>
        </div>
    </template>
    <template id="add_podcast_addon" name="Podcast Addon for Reservations">
        <div t-if="podcast_types" class="form-group col-md-6 mt-2">
            <input type="checkbox" class="ou-reset" id="add_podcast_studio" name="add_podcast_studio"/>
            <label class="ml-2 mb-0" for="add_podcast_studio">Add Podcast Studio Equipment</label><br/>
        </div>
    </template>
    <template id="harmony_reservation_form" name="Harmony Reservation Form">
        <div class="d-none js_harmony_reservation">
            <section class="harmony_reservation">
                <h4 class="" >Extra Info</h4>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label class="col-form-label" for="room_type_id">Guest Name</label>
                        <input type="text" name="guest_name" class="form-control"/>
                    </div>
                    <div class="form-group col-md-6">
                        <label class="col-form-label" for="room_type_id">Guest Email</label>
                        <input type="email" name="guest_email" class="form-control"/>
                    </div>
                </div>
            </section>
            <section class="border-bottom-0">
                <t t-call="outpostnosara.confirm_harmony_reservation_button"/>
            </section>
        </div>
    </template>
    <template id="reservation" name="Reservation Page">
        <t t-call="website.layout">
            <t t-set="additional_title">Reservation Page</t>
            <t t-set="no_footer" t-value="1"/>

            <div id="wrap">
                <section class="s_cover pt64 pb96 o_colored_level s_parallax_no_overflow_hidden undefined o_cc o_cc3" data-scroll-background-ratio="0" data-snippet="s_cover" data-name="Cover" data-oe-shape-data="{'shape':'web_editor/Origins/15','flip':['y']}" style="position: relative;">
                    <div class="o_we_shape o_web_editor_Origins_15" style="background-image: url('/web_editor/shape/web_editor/Origins/15.svg?c4=%23FCFCFA&amp;flip=y'); background-color: rgba(255, 255, 255, 0) !important; background-position: 50% 100%;"/>
                    <div class="s_allow_columns container">
                        <h1 style="text-align: center;" class='antonio'>
                            <font style="font-size: 62px; font-weight: bold;">RESERVATION</font>
                        </h1>
                        <p class="lead mx-auto" style="text-align: center;max-width: 540px;">
                            Please fill out the reservation form below. Once your reservation is complete,
                            you will receieve a confirmation email with all your reservation details.
                            If you have any questions, please email reservations@outpostnosara.com.
                        </p>
                    </div>
               </section>
                <t t-call="outpostnosara.reservation_form"/>
            </div>
        </t>
    </template>
    <template id="confirm_harmony_reservation_button" name="Reservation validator button">
        <div class="text-right mt-3">
            <button id="validate_harmony_reservation" type="button" class="btn btn-primary">
                Confirm Reservation
            </button>
        </div>
    </template>
    <template id="reservation_validator_button" name="Reservation validator button">
        <div class="text-right mt-3">
            <button id='validate_reservation' type='button' class="btn btn-primary text-uppercase">
                Validate Reservation
                <i class="fa fa-chevron-right"></i>
            </button>
        </div>
    </template>
    <template id="reservation_confirmation" name="Reservation Confirmation Page">
        <t t-call="website.layout">
            <div id="wrap">
                <!--  banner  -->
                <section class="s_cover pt64 pb96 o_colored_level s_parallax_no_overflow_hidden undefined o_cc o_cc3" data-scroll-background-ratio="0" data-snippet="s_cover" data-name="Cover" data-oe-shape-data="{'shape':'web_editor/Origins/15','flip':['y']}" style="position: relative;">
                    <div class="o_we_shape o_web_editor_Origins_15" style="background-image: url('/web_editor/shape/web_editor/Origins/15.svg?c4=%23FCFCFA&amp;flip=y'); background-color: rgba(255, 255, 255, 0) !important; background-position: 50% 100%;"/>
                    <div class="s_allow_columns container">
                         <h1 style="text-align: center;" class='antonio'>
                            <font style="font-size: 62px; font-weight: bold;">RESERVATION</font>
                        </h1>
                        <p class="lead mx-auto" style="text-align: center;max-width: 540px;">
                            Thank you for considering Outpost Nosara to be your next work and
                            social membership club. To complete your application, please review
                            and complete the intake form below.
                        </p>
                    </div>
                </section>
                <div class="container">
                    <div class="row mt16 o_portal_invoice_sidebar">
                        <!-- Sidebar -->
                        <t t-call="portal.portal_record_sidebar">
                            <t t-set="classes" t-value="'col-lg-auto d-print-none'"/>
                            <t t-set="title">
                                <h2 class="mb-0">
                                    <b t-if="invoice.amount_residual > 0" t-field="invoice.amount_residual"/>
                                    <b t-else="1" t-field="invoice.amount_total"/>
                                </h2>
                            </t>

                            <t t-set="entries">
                                <ul class="list-group list-group-flush flex-wrap flex-row flex-lg-column">
                                    <li class="list-group-item flex-grow-1">
                                        <div class="o_download_pdf btn-toolbar flex-sm-nowrap">
                                            <div class="btn-group  flex-grow-1 mr-1 mb-1">
                                                <a class="btn btn-secondary btn-block o_download_btn" t-att-href="invoice.get_portal_url(report_type='pdf', download=True)" title="Download"><i class="fa fa-download"/> Download</a>
                                            </div>
                                            <div class="btn-group flex-grow-1 mb-1">
                                                <a class="btn btn-secondary btn-block o_print_btn o_portal_invoice_print" t-att-href="invoice.get_portal_url(report_type='pdf')" id="print_invoice_report" title="Print" target="_blank"><i class="fa fa-print"/> Print</a>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </t>
                        </t>

                        <!-- Page Content -->
                        <div id="invoice_content" class="col-12 col-lg">
                            <div class="row mr16">
                                <div t-if="(transaction and (transaction.state == 'done' or transaction.acquirer_id.provider == 'immediate_credit')) or reservation.preconfirm" class="col-lg-12 mr16 ml16 alert alert-dismissable alert-success" role="alert">
                                    <a href="#" class="close" data-dismiss="alert" aria-label="close" title="close">×</a>
                                    <h4>Thank you for your Reservation!</h4>
                                </div>
                                <div t-elif="(transaction and transaction.state == 'pending')" class="col-lg-12 mr16 ml16 alert alert-dismissable alert-warning" role="alert">
                                    <a href="#" class="close" data-dismiss="alert" aria-label="close" title="close">×</a>
                                    <h4>Your reservation will be confirmed after your pay.</h4>
                                    <span t-if="transaction.acquirer_id.pending_msg" t-raw="transaction.acquirer_id.pending_msg"/>
                                </div>
                                <div t-if="error" t-attf-class="'col-lg-12 mr16 ml16 alert alert-dismissable' #{'alert-danger' if error else 'alert-warning'}" role="alert">
                                    <a href="#" class="close" data-dismiss="alert" aria-label="close" title="close">×</a>
                                    <h3>Error: <t t-esc="error"/></h3>
                                </div>
                            </div>

                            <div class="o_portal_html_view shadow p-3">
                                <iframe id="invoice_html" class="mt8 mb8" width="100%" height="100%" frameborder="0" scrolling="no" t-att-src="invoice.get_portal_url(report_type='html')"/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    <template id="portal_docs_entry" inherit_id="portal.portal_docs_entry">
        <xpath expr='//a' position="before">
            <t t-set="hide_documents" t-value="['Timesheets', 'Tasks', 'Tickets', 'Projects', 'Purchase Orders', 'Folios']"/>
        </xpath>
        <xpath expr='//a' position="attributes">
            <attribute name="t-if"> not title in hide_documents or (user_id.has_group('base.group_user') and not user_id.partner_id.is_harmony)</attribute>
        </xpath>
    </template>
</odoo>
